{% extends "base.html" %}

{% block content %}
<head>
    <meta charset="UTF-8">
    <title>{{ product.product_name }} - Product Details</title>
</head>
<body>
    <!-- Product Details Section -->
    <h1>{{ product.product_name }}</h1>
    <p><strong>Price:</strong> ${{ product.price }}</p>
    <p><strong>Availability:</strong> {% if product.available %}In Stock{% else %}Out of Stock{% endif %}</p>
    <!-- Include a description if available -->
    {% if product.description %}
        <p><strong>Description:</strong> {{ product.description }}</p>
    {% endif %}
    
    <!-- Sellers Section -->
    <h2>Sellers</h2>
    {% if sellers %}
        <table>
            <tr>
                <th>Seller</th>
                <th>Quantity in Stock</th>
                <th>Action</th>
            </tr>
            {% for seller in sellers %}
            <tr>
                <td>Seller {{ seller.seller_id }}</td>
                <td>{{ seller.product_quantity }}</td>
                <td>
                    <form action="{{ url_for('carts.add_to_cart') }}" method="post">
                        <input type="hidden" name="product_id" value="{{ product.product_id }}">
                        <input type="hidden" name="seller_id" value="{{ seller.seller_id }}">
                        <input type="number" name="quantity" min="1" max="{{ seller.product_quantity }}" placeholder="Qty">
                        <button type="submit">Add to Cart</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No sellers available for this product at the moment.</p>
    {% endif %}

    <!-- Reviews Section -->
    <h2>Reviews</h2>
    {% if reviews %}
        {% for review in reviews %}
            <div class="review">
                <p><strong>Rating:</strong> {{ review.stars }}/5</p>
                <p><strong>Review:</strong> {{ review.review_text }}</p>
                <p><small>Written by User {{ review.user_id }} on {{ review.time_written }}</small></p>
                {% if review.images %}
                    <div class="review-images">
                        {% for image in review.images %}
                            <img src="{{ image }}" alt="Review Image">
                        {% endfor %}
                    </div>
                {% endif %}
                <p><strong>Upvotes:</strong> {{ review.upvotes }}</p>
            </div>
        {% endfor %}
    {% else %}
        <p>No reviews for this product yet. Be the first to review!</p>
    {% endif %}
</body>
{% endblock %}
