{% extends "base.html" %}

{% block content %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ product.product_name }} - Product Details</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 4px; /* Reduced padding for shorter rows */
        }
        th {
            background-color: #f2f2f2;
            text-align: left;
        }
        td {
            vertical-align: top;
        }
        th:nth-child(1), td:nth-child(1) {
            width: 20%; /* Adjusted column width to make columns smaller */
        }
        th:nth-child(2), td:nth-child(2) {
            width: 20%; /* Adjusted column width to make columns smaller */
        }
        th:nth-child(3), td:nth-child(3) {
            width: 60%; /* Adjusted column width to make columns smaller */
        }
        .quantity-input {
            width: 60px; /* Made the quantity input shorter */
            display: inline-block;
        }
        .add-to-cart-btn {
            display: inline-block;
        }
    </style>
</head>
<body>
    <!-- Product Details Section -->
    <h1>{{ product.product_name }}</h1>
    <p><strong>Price:</strong> ${{ product.price }}</p>
    <p><strong>Availability:</strong> {% if product.available %}In Stock{% else %}Out of Stock{% endif %}</p>
    <!-- Include a description if available -->
    {% if product.description %}
        <p><strong>Description:</strong> {{ product.description }}</p>
    {% endif %}
    
    <!-- Sellers Section -->
    <h2>Sellers</h2>
    {% if sellers %}
        <table>
            <tr>
                <th>Seller</th>
                <th>Quantity in Stock</th>
                <th>Action</th>
            </tr>
            {% for seller in sellers %}
            <tr>
                <td>Seller {{ seller.seller_id }}</td>
                <td>{{ seller.product_quantity }}</td>
                <td>
                    <form action="{{ url_for('carts.add_to_cart') }}" method="post">
                        <input type="hidden" name="product_id" value="{{ product.product_id }}">
                        <input type="hidden" name="seller_id" value="{{ seller.seller_id }}">
                        <input type="number" name="quantity" min="1" max="{{ seller.product_quantity }}" placeholder="Qty" class="quantity-input">
                        <button type="submit" class="btn btn-primary add-to-cart-btn">Add to Cart</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No sellers available for this product at the moment.</p>
    {% endif %}

    <!-- Reviews Section -->
    <h2>Reviews</h2>
    {% if reviews %}
        <table>
            <tr>
                <th>Rating</th>
                <th>Review</th>
                <th>Details</th>
                <th>Upvotes</th>
            </tr>
            {% for review in reviews %}
            <tr>
                <td>{{ review.stars }}/5</td>
                <td>{{ review.review_text }}</td>
                <td>Written by User {{ review.user_id }} on {{ review.time_written }}</td>
                <td>{{ review.upvotes }}</td>
            </tr>
            {% endfor %}
        </table>
    {% else %}
        <p>No reviews for this product yet. Be the first to review!</p>
    {% endif %}
</body>
</html>
{% endblock %}
